<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="popup_account_invoice_refund">
        <div class="modal-dialog">
            <div class="popup touch-scrollable scrollable-y" style="max-height: 600px;min-height: 300px;height: fit-content;">
                <div class="card">
                    <t t-if="widget.options.title">
                        <h4 class="card-title">
                            <t t-esc="widget.options.title"/>
                        </h4>
                    </t>
                    <div class="card-content">
                        <t t-if="widget.options.invoice">
                            <div class="row">
                                <label class="label voucher-label">Método de crédito</label>
                                <select class='form-control voucher-select field' name='refund_method'>
                                    <option value='refund'>
                                        Reembolso parcial
                                    </option>
                                    <option value='cancel'>
                                        Reembolso completo
                                    </option>
                                    <option value='modify'>
                                        Reembolso total y borrador de factura
                                    </option>
                                </select>
                            </div>
                            <div class="row">
                                <label class="label voucher-label">Razón</label>
                                <input type="text" class="form-control field" name="reason"/>
                            </div>
                            <div class="row">
                                <label class="label voucher-label">Fecha de Devolución<i class="fa fa-calendar"></i></label>
                                <input type="text" class="form-control datepicker field" name="date"/>
                            </div>
                            <div class="row">
                                <span class="label voucher-label">Usar diario especial</span>
                                <select class='form-control voucher-select field' name='journal_id'>
                                    <t t-if="widget.pos.account_journals">
                                        <t t-foreach='widget.pos.account_journals' t-as='journal'>
                                            <t t-if="journal.pos_method_type == 'default'">
                                                <option t-att-value='journal.id'>
                                                    <t t-esc='journal.name'/>
                                                </option>
                                            </t>
                                        </t>
                                    </t>
                                </select>
                            </div>
                            <span class="card-issue"/>
                            <div class="form-footer text-center">
                                <div class="btn btn-success pull-right confirm">
                                    Confirmar <i class='fa fa-keyboard'/> (Enter)
                                </div>
                                <div class="btn btn-danger pull-left cancel">
                                    Cerrar <i class='fa fa-keyboard'/> (ESC)
                                </div>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="popup_invoice_register_payment">
        <div class="modal-dialog">
            <div class="popup popup-text" style="height: 35%">
                <div class="card">
                    <div class="card-content">
                        <t t-if="widget.options.title">
                            <h4 class="card-title">
                                <t t-esc="widget.options.title"/>
                            </h4>
                        </t>
                        <t t-if="widget.options.invoice">
                            <div class="row">
                                <label class="label voucher-label">Importe</label>
                                <input type="number" class="form-control field" t-att-value="widget.options.invoice.amount_residual" name="residual"/>
                            </div>
                            <t t-if="widget.pos.account_journals">
                                <div class="row">
                                    <span class="label voucher-label">Diario</span>
                                    <select class='form-control voucher-select field' name='journal_id'>
                                        <t t-foreach='widget.pos.account_journals' t-as='journal'>
                                            <t t-if="journal.pos_method_type == 'default'">
                                                <option t-att-value='journal.id'>
                                                    <t t-esc='journal.name'/>
                                                </option>
                                            </t>
                                        </t>
                                    </select>
                                </div>
                            </t>
                        </t>
                    </div>
                    <span class="card-issue"/>
                    <div class="form-footer text-center">
                        <div class="btn btn-success pull-right confirm">
                            Registrar <i class='fa fa-keyboard'/> (Enter)
                        </div>
                        <div class="btn btn-danger pull-left cancel">
                            Cerrar <i class='fa fa-keyboard'/> (ESC)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="InvoiceScreenHeader">
        <div class="oe_status shop_logo invoices-screen" title="Pantalla de facturas">
            <img class="logo_shop_header" src="/pos_retail/static/src/icons/invoice.png"/>
            <span class="keyboard-shortcut">I</span>
        </div>
    </t>

    <t t-name="InvoiceScreen">
        <div class="clientlist-screen screen">
            <div class="full_width screen-content">
                <section class="top-content">
                    <span class='button back'>
                        Regresar
                    </span>
                    <span class='searchbox search-invoice'>
                        <input placeholder='Search Invoice' />
                        <span class="search-clear left">
                            <i class="fa fa-search"></i>
                        </span>
                        <span class="search-clear right">
                            <i class="fa fa-remove"></i>
                        </span>
                    </span>
                    <span class='searchbox'></span>
                    <span class='button button-top-right highlight invoices_draft'>
                        Solo borrador
                        <i class='fa fa-info'></i>
                    </span>
                </section>
                <section class="full-content">
                    <div class='window'>
                        <section class='subwindow collapsed'>
                            <div class='subwindow-container collapsed'>
                                <div class='subwindow-container-fix invoice-details-contents'>
                                </div>
                            </div>
                        </section>
                        <section class='subwindow'>
                            <div class='subwindow-container'>
                                <div class='subwindow-container-fix touch-scrollable scrollable-y'>
                                    <table class='touch-scrollable scrollable-y client-list'>
                                        <thead>
                                            <tr>
                                                <th><a href="#" class="sort sort_by_invoice_id">ID</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_create_date">Fecha factura</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_name">Nombre</a></th>
                                                <th>Referencia</th>
                                                <th><a href="#" class="sort sort_by_invoice_origin">Origen</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_partner_name">Cliente</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_payment_term_id">Condiciones de pago</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_date_invoice">Fecha factura</a></th>
                                                <th><a href="#" class="sort sort_by_invoice_user_id">Vendedor</a></th>
                                                <th class="text-right"><a href="#" class="sort sort_by_invoice_amount_tax">IVA</a></th>
                                                <th class="text-right"><a href="#" class="sort sort_by_invoice_amount_total">Total</a></th>
                                                <th class="text-right"><a href="#" class="sort sort_by_invoice_residual">Importe adeudado</a></th>
                                                <th class="text-right"><a href="#" class="sort sort_by_invoice_state">Estado</a></th>
                                            </tr>
                                        </thead>
                                        <tbody class='client-list-contents invoice-list'>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </section>
                    </div>
                </section>
            </div>
        </div>
    </t>

    <t t-name="InvoiceRow">
        <tr t-attf-class='invoice-line #{invoice.state}' t-att-data-id='invoice.id'>
            <td>
                <t t-esc='invoice.id'/>
            </td>
            <td>
                <t t-esc='invoice.create_date'/>
            </td>
            <td>
                <t t-if="invoice.name">
                    <t t-esc='invoice.name'/>
                </t>
                <t t-if="!invoice.name">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.ref">
                    <t t-esc='invoice.ref'/>
                </t>
                <t t-if="!invoice.ref">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.invoice_origin">
                    <t t-esc='invoice.invoice_origin'/>
                </t>
                <t t-if="!invoice.invoice_origin">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.partner_id">
                    <t t-esc='invoice.partner_id[1]'/>
                </t>
                <t t-if="!invoice.partner_id">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.payment_term_id">
                    <t t-esc='invoice.payment_term_id[1]'/>
                </t>
                <t t-if="!invoice.payment_term_id">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.invoice_date">
                    <t t-esc='invoice.invoice_date'/>
                </t>
                <t t-if="!invoice.invoice_date">
                    N/A
                </t>
            </td>
            <td>
                <t t-if="invoice.invoice_user_id">
                    <t t-esc='invoice.invoice_user_id[1]'/>
                </t>
                <t t-if="!invoice.invoice_user_id">
                    N/A
                </t>
            </td>
            <td class="text-right">
                <t t-esc='widget.format_currency_no_symbol(invoice.amount_tax)'/>
            </td>
            <td class="text-right">
                <t t-esc='widget.format_currency_no_symbol(invoice.amount_total)'/>
            </td>
            <td class="text-right">
                <t t-esc='widget.format_currency_no_symbol(invoice.amount_residual)'/>
            </td>
            <td class="text-right">
                <t t-if="invoice.state == 'draft'">Borrador</t>
                <t t-if="invoice.state == 'posted'">Publicado</t>
            </td>
        </tr>
    </t>

    <t t-name="InvoiceForm">
<!--        <t t-set="state" t-value="invoice.state"/>-->
<!--        <t t-set="type" t-value="invoice.type"/>-->
<!--        <t t-set="invoice_payment_state" t-value="invoice.invoice_payment_state"/>-->
        <section class='touch-scrollable scrollable-y client-details' style="max-height: 600px;min-height: 300px;height: fit-content;">
            <t t-if='invoice.partner_id'>
                <div class='client-picture'>
                    <img t-att-src='widget.partner_icon_url(invoice.partner_id[0])' />
                </div>
            </t>
            <div class='client-name'>
                <t t-if="invoice.name">
                    <t t-esc="invoice.name"/>
                </t>
                <t t-if="!invoice.name">
                    N/A
                </t>
            </div>
            <div class='client-details-box clearfix'>
                <div class='client-details-left'>
                    <div class='client-detail'>
                        <span class='label'>Cliente</span>
                        <t t-if='invoice.partner_id'>
                            <span class='detail client-address'><t t-esc='invoice.partner_id[1]' /></span>
                        </t>
                        <t t-if='!invoice.partner_id'>
                            <span class='detail client-address empty'>N/A</span>
                        </t>
                    </div>
                    <div class='client-detail'>
                        <span class='label'>Origen</span>
                        <t t-if='invoice.invoice_origin'>
                            <span class='detail client-origin'><t t-esc='invoice.invoice_origin' /></span>
                        </t>
                        <t t-if='!invoice.invoice_origin'>
                            <span class='detail client-origin empty'>N/A</span>
                        </t>
                    </div>
                    <div class='client-detail'>
                        <span class='label'>Fecha factura</span>
                        <t t-if='invoice.invoice_date'>
                            <span class='detail client-phone'><t t-esc='invoice.invoice_date' /></span>
                        </t>
                        <t t-if='!invoice.invoice_date'>
                            <span class='detail client-phone empty'>N/A</span>
                        </t>
                    </div>
                    <div class='client-detail'>
                        <div class='invoice_lines_detail'/>
                    </div>
                </div>
                <div class='client-details-right'>
                    <t t-if="invoice.state == 'draft'">
                        <div class='client-detail invoice-action post'>
                            <span class='label'>Publicado</span>
                            <button type="button" rel="tooltip" class="btn btn-default button_form">
                                <i class="fa fa-check"/>
                            </button>
                        </div>
                    </t>
                    <div class='client-detail invoice-action inv-print-invoice'>
                        <span class='label'>Imprimir factura</span>
                        <button type="button" rel="tooltip" class="btn btn-success button_form">
                            <i class="fa fa-print"/>
                        </button>
                    </div>
                    <t t-if="invoice.amount_residual > 0">
                        <div class='client-detail invoice-action inv-print-invoice-without-payment'>
                            <span class='label'>Imprimir factura (sin pagos)</span>
                            <button type="button" rel="tooltip" class="btn btn-success button_form">
                                <i class="fa fa-print"/>
                            </button>
                        </div>
                    </t>
                    <t t-if="(invoice.state == 'posted' or invoice.invoice_payment_state != 'not_paid') and ['out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'].indexOf(invoice.type) != -1">
                        <div class='client-detail invoice-action register_payment'>
                            <span class='label'>Registrar pagos</span>
                            <button type="button" rel="tooltip" class="btn btn-default button_form">
                                <i class="fa fa-pencil-square"/>
                            </button>
                        </div>
                    </t>
                    <t t-if="invoice.state == 'posted' or ['out_invoice', 'in_invoice'].indexOf(invoice.type) == -1">
                        <div class='client-detail invoice-action add_credit_note'>
                            <span class='label'>Agregar nota de crédito</span>
                            <button type="button" rel="tooltip" class="btn btn-danger button_form">
                                <i class="fa fa-pencil-square"/>
                            </button>
                        </div>
                    </t>
                    <div class='client-detail'>
                        <span class='label'>Abrir facturas</span>
                        <a class='so_link' target='_blank' t-att-href="invoice.link">(Click aquí)</a>
                    </div>
                    <div class='client-detail'>
                        <span class='label'>Términos de pago</span>
                        <t t-if='invoice.invoice_payment_term_id'>
                            <span class='detail client-email'><t t-esc='invoice.invoice_payment_term_id[1]' /></span>
                        </t>
                        <t t-if='!invoice.invoice_payment_term_id'>
                            <span class='detail client-email empty'>N/A</span>
                        </t>
                    </div>

                    <div class='client-detail state'>
                        <span class='label'>IVA</span>
                        <t t-esc='widget.format_currency(invoice.amount_tax)'/>
                    </div>
                    <div class='client-detail state'>
                        <span class='label'>Total</span>
                        <t t-esc='widget.format_currency(invoice.amount_total)'/>
                    </div>
                    <div class='client-detail state'>
                        <span class='label'>Pendiente</span>
                        <t t-esc='widget.format_currency(invoice.amount_residual)'/>
                    </div>
                </div>
            </div>
            <div class="ribbon ribbon-top-right o_widget">
                <span><t t-esc="invoice.state"/></span>
            </div>
        </section>
    </t>

    <t t-name="AccountMoveLines">
        <table class='client-list'>
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Cantidad</th>
                    <th>Desc</th>
                    <th>Precio</th>
                    <th>Crédito</th>
                    <th>Débito</th>
                    <th>Balance</th>
                    <th>Sub Total</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody class='client-list-contents'>
                <t t-foreach='account_invoice_lines' t-as='line'>
                    <tr class='client-line' t-att-data-id='line.id'>
                        <td><t t-esc='line.name'/></td>
                        <td><t t-esc='line.quantity'/></td>
                        <td><t t-esc='line.discount'/></td>
                        <td><t t-esc='line.price_unit'/></td>
                        <td><t t-esc='line.credit'/></td>
                        <td><t t-esc='line.debit'/></td>
                        <td><t t-esc='line.balance'/></td>
                        <td><t t-esc='line.price_subtotal'/></td>
                        <td><t t-esc='line.price_total'/></td>
                    </tr>
                </t>
            </tbody>
        </table>
    </t>

</templates>
